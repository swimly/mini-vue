### 创建打包环境

相比目前前端领域的打包工具，由于我们是写自己的`js库`，采用`rollup`比较合适，至于为什么，后续会出相关的文章来分析，并介绍`rollup`的具体用法。

#### 约定目录结构

首先，我们约定好目录结构，`src`用来存放库的所有代码文件，`src/index.ts`是库的打包入口文件。

``` bash
yarn init - y
```

?> 注意：由于本篇不是`rollup`的教程，所有过程都略过，只需要照着做即可。

生成`package.json`之后，就开始安装打包所需的依赖。

``` bash
cnpm i -D @babel/core @babel/preset-env @babel/preset-typescript @rollup/plugin-babel @rollup/plugin-typescript @types/jest babel-jest jest rollup tslib typescript
```

创建`rollup.config.js`

``` javascript
import typescript from '@rollup/plugin-typescript'
import pkg from './package.json'

export default {
  input: 'src/index.ts',
  output: [{
    file: pkg.main,
    format: 'cjs'
  }, {
    file: pkg.module,
    format: 'es'
  }],
  plugins: [
    typescript()
  ]
}
```

生成`tsconfig.json`

``` bash
tsc -init
```

``` json
{
  "compilerOptions": {
    "target": "es2016",
    "module": "esnext",
    "lib": ["DOM", "ES6"],
    "strict": true,
    "noImplicitAny": false,
    "moduleResolution": "node", 
    "types": ["jest"], 
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true
  }
}

```

修改`packpage.json`

``` json
{
  ...,
  "main": "dist/index.cjs.js",
  "module": "dist/index.esm.js",
  ...
}
```

创建`src/index.ts`

``` javascript
export * from './reactivity'
```

创建`src/reactivity/index.ts`

``` javascript
export {effect} from './effect'
export {reactive} from './reactive'
```

创建`src/reactivity/effect.ts`

``` javascript
export function effect {}
```

创建`src/reactivity/reactive.ts`

``` javascript
export function reactive () {}
```

到此，打包环境和测试文件就都配好了，本环境还支持`jest`测试，由于不善于写测试用例，还是选择了最为直观的方式来测试。